'use strict';/**
 * by lcs@lcs.io
 * 2017-07-16
 */(function(){'use strict';var album=window.album||'B0Z5qXGF1iS2iW';var audio=$('audio')[0];fetch('/album/'+album,{method:'POST'}).then(function(req){return req.json()}).then(function(data){var host=function(locations){for(var _host in locations){return locations[_host].scheme+'://'+locations[_host].hosts[0]}}(data.webasseturls.locations);showTitle(data.webstream.photos.map(function(photo){return photo.dateCreated.match(/\d{4}-\d\d-\d\d/)[0]}).sort());return{host:host,photos:data.webstream.photos.map(function(photo){return photo['derivatives']['2049']['checksum']}).map(function(checksum){return data.webasseturls.items[checksum]})}}).then(function(data){var photos=data.photos.map(function(item){return''+data.host+item.url_path});if(!audio)return carousel(photos);if(!audio.play)return carousel(photos);var $playButton=$('.play-button').removeClass('hide');var canPlay=true;$('img.in').prop('src',photos[0]);$playButton.on('click',function(){if(!canPlay)return;clearInterval(timeId);if(audio.paused){audio.play().catch(function(){canPlay=false});carousel(photos);$playButton.removeClass('in')}else{audio.pause();$playButton.addClass('in')}})});var showTitle=function showTitle(dateList){var $title=$('.title').html(dateList[0]+'_'+dateList[dateList.length-1]);setTimeout(function(){$title.fadeOut()},5000)};var timeId=0;var index=0;var carousel=function carousel(photos){//photos = photos.filter((a,i)=>i<3);
var speed=3*1000;var $img=$('img.photo');var $pre=$('img.preload');$img.filter('.in').prop('src',photos[index]);index=(index+1)%photos.length;$img.filter(':not(.in)').prop('src',photos[index]);timeId=setInterval(function(){$img.filter(':not(.in)').prop('src',$pre.prop('src'));$img.toggleClass('in');index=(index+1)%photos.length;$pre.prop('src',photos[index])},speed)}})();

//# sourceMappingURL=main.min.js.map